# 用户认证审核系统 - 快速测试指南

## 🧪 测试准备

确保已完成以下步骤：
1. ✅ 系统正常运行
2. ✅ 用户已登录
3. ✅ 路由配置正确

## 📋 测试场景

### 场景1：用户提交企业认证申请

#### 步骤1：打开认证申请对话框
```
方式1（推荐）：
个人中心 → 身份认证标签页 → 点击"申请认证"按钮

方式2：
直接访问 /my-verification → 点击"申请认证"按钮
```

#### 步骤2：填写企业认证信息
```
选择认证类型：企业认证

必填字段：
- 统一社会信用代码: 91110000MA01234567
- 公司名称: 测试科技有限公司
- 联系人: 测试用户
- 联系电话: 13800138000

选填字段：
- 联系邮箱: test@example.com
```

#### 步骤3：提交申请
```
点击"提交认证申请"按钮
→ 应该看到成功提示："企业认证申请已提交，请等待管理员审核"
→ 对话框自动关闭
→ 页面刷新，显示待审核状态
```

#### 预期结果
- ✅ 提示信息正确显示
- ✅ 表单验证通过
- ✅ 申请记录创建成功
- ✅ 状态显示为"待审核"
- ✅ 不能再次提交申请（按钮禁用）

---

### 场景2：用户提交个人认证申请

#### 步骤1：打开认证申请对话框
```
个人中心 → 身份认证 → 申请认证
```

#### 步骤2：填写个人认证信息
```
选择认证类型：个人认证

必填字段：
- 真实姓名: 张三
- 身份证号: 110101199001011234
- 联系电话: 13900139000

选填字段：
- 联系邮箱: zhangsan@example.com
```

#### 步骤3：提交申请
```
点击"提交认证申请"按钮
→ 成功提示："个人认证申请已提交，请等待管理员审核"
```

#### 预期结果
- ✅ 个人认证表单显示正确
- ✅ 身份证号格式验证通过
- ✅ 申请成功创建
- ✅ 状态为"待审核"

---

### 场景3：用户查看认证记录

#### 步骤1：访问认证记录页面
```
方式1：个人中心 → 身份认证标签页
方式2：直接访问 /my-verification
```

#### 步骤2：查看认证详情
```
应该看到：
- 认证类型标识（企业/个人）
- 认证状态（待审核/已通过/已驳回）
- 提交时间
- 认证信息详情
```

#### 预期结果
- ✅ 显示当前用户的所有认证记录
- ✅ 最新的申请排在最前面
- ✅ 待审核状态有黄色提示
- ✅ 待审核期间"申请认证"按钮禁用

---

### 场景4：管理员查看待审核列表

#### 步骤1：访问审核管理页面
```
导航 → 用户与权限 → 认证审核管理
或直接访问 /verification-management
```

#### 步骤2：查看统计数据
```
顶部应该显示：
[总申请数] [待审核] [已通过] [已驳回] [企业认证] [个人认证]
```

#### 步骤3：查看待审核申请
```
应该看到：
- 最新提交的申请排在最前面
- 每个申请显示完整信息
- 企业认证显示公司信息
- 个人认证显示个人信息
- 右侧有"通过"和"驳回"按钮
```

#### 预期结果
- ✅ 统计数据正确
- ✅ 待审核提示显示
- ✅ 申请列表按时间倒序
- ✅ 信息显示完整

---

### 场景5：管理员审核通过

#### 步骤1：选择待审核申请
```
在待审核列表中找到一个申请
→ 点击"通过"按钮
```

#### 步骤2：确认审核
```
弹出确认对话框
显示：
- 申请人信息
- 认证类型
- 即将创建的工作组路径
  企业：/company/公司名
  个人：/person/真实姓名

→ 点击"确认通过"
```

#### 步骤3：验证结果
```
→ 成功提示："已通过认证申请"
→ 申请状态变更为"已通过"
→ 显示审核时间和审核人
→ 显示已加入的工作组路径
```

#### 预期结果
- ✅ 确认对话框信息正确
- ✅ 状态更新成功
- ✅ 系统提示已自动创建工作组
- ✅ 申请从待审核列表移除
- ✅ 在"已通过"筛选中可见

---

### 场景6：管理员审核驳回

#### 步骤1：选择待审核申请
```
在待审核列表中找到一个申请
→ 点击"驳回"按钮
```

#### 步骤2：填写驳回原因
```
弹出驳回对话框
必须填写驳回原因：
例如："统一社会信用代码格式错误，请核实后重新提交"

→ 点击"确认驳回"
```

#### 步骤3：验证结果
```
→ 成功提示："已驳回认证申请"
→ 申请状态变更为"已驳回"
→ 显示驳回原因
→ 申请从待审核列表移除
```

#### 预期结果
- ✅ 必须填写驳回原因才能提交
- ✅ 状态更新为"已驳回"
- ✅ 驳回原因正确保存
- ✅ 用户可以在个人中心看到驳回原因

---

### 场景7：筛选和搜索功能

#### 步骤1：测试状态筛选
```
在审核管理页面
→ 选择状态下拉框
→ 选择"待审核"
→ 应该只显示待审核的申请

→ 选择"已通过"
→ 应该只显示已通过的申请

→ 选择"已驳回"
→ 应该只显示已驳回的申请
```

#### 步骤2：测试类型筛选
```
→ 选择类型下拉框
→ 选择"企业认证"
→ 应该只显示企业认证申请

→ 选择"个人认证"
→ 应该只显示个人认证申请
```

#### 步骤3：测试搜索功能
```
在搜索框输入：
- 用户名：应该找到匹配的申请
- 公司名：应该找到对应的企业认证
- 真实姓名：应该找到对应的个人认证
- 申请ID：应该找到对应的申请
```

#### 预期结果
- ✅ 筛选功能正常
- ✅ 搜索结果准确
- ✅ 可以组合筛选和搜索

---

### 场景8：表单验证测试

#### 企业认证验证
```
测试场景1：空必填项
- 不填统一社会信用代码
→ 应提示："请输入统一社会信用代码"

测试场景2：格式错误
- 输入：ABC123（长度不足18位）
→ 应提示："统一社会信用代码格式错误（应为18位数字或大写字母）"

测试场景3：手机号错误
- 输入：12345678901
→ 应提示："联系电话格式错误"
```

#### 个人认证验证
```
测试场景1：身份证号格式错误
- 输入：12345678901234567X（格式不正确）
→ 应提示："身份证号格式错误"

测试场景2：手机号错误
- 输入：12345
→ 应提示："联系电话格式错误"
```

#### 预期结果
- ✅ 所有必填项验证正常
- ✅ 格式验证准确
- ✅ 错误提示清晰

---

## 🔍 关键测试点

### 1. 状态流转测试
```
测试流程：
待审核 → 通过 → 已通过 ✅
待审核 → 驳回 → 已驳回 ✅
已驳回 → 重新申请 → 待审核 ✅
```

### 2. 权限测试
```
测试点：
- 普通用户只能看到自己的认证记录 ✅
- 管理员能看到所有认证记录 ✅
- 待审核期间不能重复申请 ✅
- 已驳回后可以重新申请 ✅
```

### 3. 数据一致性测试
```
测试点：
- 提交的数据能正确保存 ✅
- 审核结果能及时反馈 ✅
- 统计数据实时更新 ✅
- 搜索结果准确 ✅
```

### 4. 用户体验测试
```
测试点：
- 加载状态显示 ✅
- 成功/失败提示 ✅
- 按钮禁用状态 ✅
- 空数据提示 ✅
```

---

## 🐛 常见问题排查

### 问题1：提交后没有反应
**检查项**：
1. 查看浏览器控制台是否有错误
2. 检查表单验证是否通过
3. 验证网络请求是否发送成功

### 问题2：审核后状态没有更新
**检查项**：
1. 刷新页面查看是否更新
2. 检查是否有错误提示
3. 查看网络请求返回结果

### 问题3：搜索无结果
**检查项**：
1. 确认是否有匹配的数据
2. 检查搜索关键词是否正确
3. 尝试清空筛选条件

### 问题4：无法重新申请
**检查项**：
1. 确认当前状态（待审核时无法申请）
2. 已驳回状态应该可以申请
3. 已通过状态无需再申请

---

## 📊 测试数据

### 有效的测试数据

#### 企业认证
```javascript
{
  creditCode: "91110000MA01234567",  // 正确格式
  companyName: "测试科技有限公司",
  contactName: "张三",
  contactPhone: "13800138000",
  contactEmail: "test@example.com"
}
```

#### 个人认证
```javascript
{
  realName: "张三",
  idNumber: "110101199001011234",   // 正确格式
  contactPhone: "13900139000",
  contactEmail: "zhangsan@example.com"
}
```

### 无效的测试数据（用于验证）

#### 格式错误
```javascript
{
  creditCode: "ABC123",              // 太短
  idNumber: "12345",                 // 格式错误
  contactPhone: "12345678901"        // 不是1开头
}
```

---

## ✅ 测试检查清单

### 用户端功能
- [ ] 可以打开认证申请对话框
- [ ] 企业认证表单正常
- [ ] 个人认证表单正常
- [ ] 表单验证正确
- [ ] 可以提交申请
- [ ] 可以查看认证记录
- [ ] 状态显示正确
- [ ] 驳回原因可见
- [ ] 待审核时不能重复申请
- [ ] 已驳回后可以重新申请

### 管理员功能
- [ ] 可以访问审核管理页面
- [ ] 统计数据正确
- [ ] 待审核列表正常
- [ ] 可以审核通过
- [ ] 可以审核驳回
- [ ] 必须填写驳回原因
- [ ] 状态筛选正常
- [ ] 类型筛选正常
- [ ] 搜索功能正常
- [ ] 审核后状态更新

### 系统功能
- [ ] 路由配置正确
- [ ] 页面导航正常
- [ ] 数据持久化
- [ ] 错误处理
- [ ] 成功提示
- [ ] 加载状态

---

## 🎯 测试完成标准

当以下所有检查项都通过时，测试完成：

1. ✅ 用户可以正常提交企业认证申请
2. ✅ 用户可以正常提交个人认证申请
3. ✅ 表单验证功能正常
4. ✅ 管理员可以查看待审核列表
5. ✅ 管理员可以审核通过
6. ✅ 管理员可以审核驳回
7. ✅ 驳回原因必填验证
8. ✅ 筛选功能正常
9. ✅ 搜索功能正常
10. ✅ 状态流转正确
11. ✅ 用户体验良好
12. ✅ 无明显bug

---

**测试建议**：按照场景顺序依次测试，每个场景测试完成后打勾✅
